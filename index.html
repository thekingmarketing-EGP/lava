<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="theme-color" content="#2a0000">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>Chicken Lava Ultra PRO ğŸ—ğŸŒ‹</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">

<style>
  :root {
    --primary: #ff4757;
    --secondary: #2f3542;
    --accent: #ffa502;
    --success: #2ed573;
    --bg-dark: #1e272e;
    --glass: rgba(255, 255, 255, 0.1);
    --glass-border: rgba(255, 255, 255, 0.2);
    --font-main: 'Tajawal', sans-serif;
  }

  * { box-sizing: border-box; user-select: none; -webkit-user-select: none; }

  body {
    margin: 0;
    background-color: #000;
    font-family: var(--font-main);
    overflow: hidden;
    touch-action: none;
    height: 100dvh; /* Ø§Ø³ØªØ®Ø¯Ø§Ù… dvh Ù„Ù„ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø§Ù„Ø¬ÙˆØ§Ù„ */
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù„Ø¹Ø¨Ø© ØªØ­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ù†Ø³Ø¨Ø© Ø§Ù„Ø¹Ø±Ø¶ Ù„Ù„Ø§Ø±ØªÙØ§Ø¹ Ù„ÙƒÙ† ØªÙ…Ù„Ø£ Ø§Ù„Ø´Ø§Ø´Ø© Ø¨Ø°ÙƒØ§Ø¡ */
  #game-stage {
    position: relative;
    width: 100%;
    height: 100%;
    max-width: 500px; /* Ø¹Ø±Ø¶ Ù…Ø«Ø§Ù„ÙŠ Ù„Ù„Ø¬ÙˆØ§Ù„ */
    background: linear-gradient(180deg, #2b0000 0%, #1a0000 100%);
    overflow: hidden;
    box-shadow: 0 0 50px rgba(255, 71, 87, 0.2);
  }

  /* Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© */
  #bg-layer {
    position: absolute;
    inset: 0;
    background: url('bg.png') no-repeat bottom center;
    background-size: cover;
    opacity: 0.4;
    z-index: 1;
  }

  /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¹Ù„ÙˆÙŠØ© (HUD) */
  .hud {
    position: absolute;
    top: env(safe-area-inset-top, 20px); /* Ø§Ø­ØªØ±Ø§Ù… Ø§Ù„Ù†ÙˆØªØ´ ÙÙŠ Ø§Ù„Ø¢ÙŠÙÙˆÙ† */
    left: 20px;
    right: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    z-index: 100;
    pointer-events: none;
  }

  .score-box, .lives-box {
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    padding: 8px 15px;
    border-radius: 20px;
    border: 1px solid var(--glass-border);
    color: white;
    font-weight: 800;
    font-size: 1.2rem;
    display: flex;
    align-items: center;
    gap: 8px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
  }

  .lives-box span { color: var(--primary); font-size: 1.4rem; }

  /* Ø§Ù„Ù„Ø§Ø¹Ø¨ */
  #player {
    position: absolute;
    bottom: 10%; /* Ø§Ø±ØªÙØ§Ø¹ Ù†Ø³Ø¨ÙŠ */
    left: 50%;
    width: 80px;
    height: 80px;
    background: url('p.png') no-repeat center;
    background-size: contain;
    z-index: 50;
    transform: translate3d(-50%, 0, 0); /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡ */
    will-change: transform;
    filter: drop-shadow(0 10px 10px rgba(0,0,0,0.5));
    transition: transform 0.05s linear; /* Ø­Ø±ÙƒØ© Ù†Ø§Ø¹Ù…Ø© Ø¬Ø¯Ø§Ù‹ */
  }

  /* Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ø§Ù‚Ø·Ø© */
  .item {
    position: absolute;
    width: 60px;
    height: 60px;
    z-index: 10;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 40px;
    will-change: transform;
  }
  
  .item img { width: 100%; height: 100%; object-fit: contain; filter: drop-shadow(0 5px 5px rgba(0,0,0,0.3)); }

  /* Ø§Ù„Ø´Ø§Ø´Ø§Øª (Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ÙˆØ§Ù„Ù†Ù‡Ø§ÙŠØ©) */
  .overlay {
    position: absolute;
    inset: 0;
   background-image: linear-gradient(to bottom, rgba(0,0,0,0.3), rgba(0,0,0,0.8)), url('bg.jpg');

    background-repeat: no-repeat;

    background-position: center;

    /* Ù‡Ø°Ø§ Ø§Ù„Ø³Ø·Ø± ÙŠØ¶Ù…Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø­ÙˆØ§Ù Ø³ÙˆØ¯Ø§Ø¡ ÙˆØ¹Ø¯Ù… Ù‚Øµ Ø§Ù„ØµÙˆØ±Ø© */

    background-size: 100% 100%;
    -webkit-backdrop-filter: blur(8px);
    z-index: 200;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: 20px;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
  }

  .overlay.active { opacity: 1; pointer-events: all; }

  h1 {
    font-size: 3rem;
    margin: 0 0 10px;
    background: linear-gradient(to bottom, #ffcc00, #ff4757);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    filter: drop-shadow(0 4px 0 rgba(0,0,0,0.5));
  }

  .btn-start {
    background: linear-gradient(45deg, var(--primary), #ff6b81);
    color: white;
    border: none;
    padding: 15px 60px;
    font-size: 1.5rem;
    font-family: var(--font-main);
    font-weight: 900;
    border-radius: 50px;
    cursor: pointer;
    margin-top: 30px;
    box-shadow: 0 10px 20px rgba(255, 71, 87, 0.4);
    transition: transform 0.2s, box-shadow 0.2s;
    position: relative;
    overflow: hidden;
  }

  .btn-start:active { transform: scale(0.95); box-shadow: 0 5px 10px rgba(255, 71, 87, 0.4); }

  /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø¨ØµØ±ÙŠØ© */
  .shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
  @keyframes shake { 10%, 90% { transform: translate3d(-2px, 0, 0); } 20%, 80% { transform: translate3d(4px, 0, 0); } 30%, 50%, 70% { transform: translate3d(-8px, 0, 0); } 40%, 60% { transform: translate3d(8px, 0, 0); } }

  .flash-red { animation: flashRed 0.3s; }
  @keyframes flashRed { 0% { box-shadow: inset 0 0 100px rgba(255,0,0,0.8); } 100% { box-shadow: none; } }

  .flash-blue { animation: flashBlue 0.3s; }
  @keyframes flashBlue { 0% { background: rgba(0, 168, 255, 0.4); } 100% { background: transparent; } }

  /* ØµÙˆØ±Ø© Ø§Ù„Ø®Ø·Ø£ Ø§Ù„ÙƒÙˆÙ…ÙŠØ¯ÙŠ */
  #comic-effect {
    position: absolute;
    bottom: 20px;
    right: -200px;
    width: 150px;
    z-index: 150;
    transition: right 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
    filter: drop-shadow(-5px 5px 10px rgba(0,0,0,0.5));
    pointer-events: none;
  }
  #comic-effect.show { right: 10px; }

  /* Ù†Ù‚Ø§Ø· Ø¹Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø§Ù„ØªÙ‚Ø§Ø· */
  .float-score {
    position: absolute;
    color: var(--accent);
    font-weight: bold;
    font-size: 24px;
    pointer-events: none;
    animation: floatUp 0.8s forwards;
    z-index: 60;
    text-shadow: 0 2px 4px rgba(0,0,0,0.8);
  }
  @keyframes floatUp { 0% { transform: translateY(0) scale(1); opacity: 1; } 100% { transform: translateY(-50px) scale(1.5); opacity: 0; } }

</style>
</head>
<body>

<div id="game-stage">
  <div id="bg-layer"></div>
  
  <div class="hud">
    <div class="score-box">
      <span>ğŸ’</span> <span id="score-val">0</span>
    </div>
    <div class="lives-box">
      <span id="lives-val">â¤ï¸â¤ï¸â¤ï¸</span>
    </div>
  </div>

  <div id="player"></div>

  <img id="comic-effect" src="false.png" alt="Ouch!">

  <div id="start-screen" class="overlay active">
    <img src="logo.png" style="width: 120px; margin-bottom: 20px; animation: floatIcon 3s infinite ease-in-out;">
    <h1>Chicken Lava</h1>
    <p style="color: #eee; font-size: 1.1rem; line-height: 1.6;">
      Ø­Ø±Ùƒ Ø¥ØµØ¨Ø¹Ùƒ Ù„Ù„ØªØ­ÙƒÙ… ğŸ—<br>ØªØ¬Ù†Ø¨ Ø§Ù„Ù†Ø§Ø± ğŸ”¥ ÙˆØ§Ù„Ø«Ù„Ø¬ ğŸ§Š
    </p>
    <button class="btn-start" onclick="game.start()">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯ÙŠ</button>
  </div>

  <div id="game-over-screen" class="overlay">
    <h1 style="color: var(--primary)">Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©</h1>
    <p style="color: #fff; font-size: 1.5rem;">Ø§Ù„Ù†ØªÙŠØ¬Ø©: <span id="final-score" style="color:var(--accent)">0</span></p>
    <button class="btn-start" onclick="game.start()">Ø§Ù„Ø¹Ø¨ Ù…Ø¬Ø¯Ø¯Ø§Ù‹ ğŸ”„</button>
  </div>
</div>

<script>
// Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£ØµÙˆØ§Øª (ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø§Ù„Ù…Ù„ÙØ§Øª Ù…ÙˆØ¬ÙˆØ¯Ø©)
const audio = {
  bgm: new Audio('bgm.mp3'),
  catch: new Audio('catch.mp3'),
  hurt: new Audio('hurt.mp3'),
  false: new Audio('false.mp3'),
  low: new Audio('f2.mp3')
};
audio.bgm.loop = true;

// ÙƒØ§Ø¦Ù† Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
const game = {
  active: false,
  score: 0,
  lives: 3,
  speed: 4,
  spawnRate: 1000,
  lastSpawn: 0,
  items: [],
  playerX: 50, // Ù†Ø³Ø¨Ø© Ù…Ø¦ÙˆÙŠØ©
  
  // Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù€ DOM Ù„Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª (Performance)
  elements: {
    stage: document.getElementById('game-stage'),
    player: document.getElementById('player'),
    score: document.getElementById('score-val'),
    lives: document.getElementById('lives-val'),
    startScreen: document.getElementById('start-screen'),
    endScreen: document.getElementById('game-over-screen'),
    finalScore: document.getElementById('final-score'),
    comic: document.getElementById('comic-effect')
  },

  init() {
    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ù„Ù…Ø³ ÙˆØ§Ù„Ù…Ø§ÙˆØ³
    const moveHandler = (e) => {
      if (!this.active) return;
      e.preventDefault(); // Ù…Ù†Ø¹ Ø³Ø­Ø¨ Ø§Ù„ØµÙØ­Ø©
      
      const clientX = e.touches ? e.touches[0].clientX : e.clientX;
      const rect = this.elements.stage.getBoundingClientRect();
      
      // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù„Ø­Ø§ÙˆÙŠØ©
      let x = ((clientX - rect.left) / rect.width) * 100;
      
      // ØªÙ‚ÙŠÙŠØ¯ Ø§Ù„Ø­Ø±ÙƒØ© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¥Ø·Ø§Ø± (Clamping)
      this.playerX = Math.max(10, Math.min(90, x));
      
      // ØªØ­Ø±ÙŠÙƒ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… transform Ù„Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¹Ø§Ù„ÙŠ
      this.elements.player.style.transform = `translate3d(-50%, 0, 0) left(${this.playerX}%)`; 
      // Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„Ø£ÙØ¶Ù„ Ù‡Ùˆ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ± ÙÙ‚Ø·ØŒ ÙˆØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ø±ÙƒØ© ÙÙŠ Ø­Ù„Ù‚Ø© Ø§Ù„Ø±Ø³Ù… (Render Loop)ØŒ Ù„ÙƒÙ† Ù‡Ù†Ø§ Ù†Ø³ØªØ®Ø¯Ù… CSS Left Ù„Ù„ØªØ¨Ø³ÙŠØ· Ù…Ø¹ Transform
      this.elements.player.style.left = `${this.playerX}%`;
    };

    this.elements.stage.addEventListener('mousemove', moveHandler);
    this.elements.stage.addEventListener('touchmove', moveHandler, { passive: false });
    
    // Ø­Ù„Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
    requestAnimationFrame((t) => this.loop(t));
  },

  start() {
    this.active = true;
    this.score = 0;
    this.lives = 3;
    this.speed = 4; // Ø³Ø±Ø¹Ø© Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ©
    this.items.forEach(i => i.el.remove());
    this.items = [];
    
    this.updateUI();
    this.elements.startScreen.classList.remove('active');
    this.elements.endScreen.classList.remove('active');
    this.elements.comic.classList.remove('show');
    
    audio.bgm.currentTime = 0;
    audio.bgm.play().catch(e => console.log("Audio play blocked by browser"));
  },

  spawn() {
    const isGood = Math.random() > 0.4; // 60% ÙØ±ØµØ© Ø¸Ù‡ÙˆØ± Ø·Ø¹Ø§Ù…
    const item = document.createElement('div');
    item.className = 'item';
    
    // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†ÙˆØ¹ ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰
    const type = isGood 
      ? (Math.random() > 0.5 ? 'f.png' : 'bu.png') 
      : (Math.random() > 0.5 ? 'ğŸ”¥' : 'ğŸ§Š');
      
    if (isGood) {
      item.innerHTML = `<img src="${type}">`;
    } else {
      item.textContent = type;
    }

    // Ù…ÙˆÙ‚Ø¹ Ø¹Ø´ÙˆØ§Ø¦ÙŠ
    const startX = Math.random() * 80 + 10;
    item.style.left = `${startX}%`;
    item.style.top = '-80px';
    
    this.elements.stage.appendChild(item);
    
    this.items.push({
      el: item,
      y: -80,
      x: startX,
      isGood: isGood,
      type: type
    });
  },

  loop(timestamp) {
    if (this.active) {
      // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¹Ù†Ø§ØµØ±
      if (timestamp - this.lastSpawn > (10000 / (this.speed * 10))) { 
        this.spawn();
        this.lastSpawn = timestamp;
        this.speed += 0.002; // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ØµØ¹ÙˆØ¨Ø© ØªØ¯Ø±ÙŠØ¬ÙŠØ§Ù‹
      }

      // ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø¹Ù†Ø§ØµØ± ÙˆØ§Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù„ØªØµØ§Ø¯Ù…
      const playerRect = this.elements.player.getBoundingClientRect();
      
      // Ø§Ù„ØªÙƒØ±Ø§Ø± Ø§Ù„Ø¹ÙƒØ³ÙŠ Ù„Ù„Ø­Ø°Ù Ø§Ù„Ø¢Ù…Ù†
      for (let i = this.items.length - 1; i >= 0; i--) {
        let item = this.items[i];
        item.y += this.speed;
        item.el.style.transform = `translate3d(0, ${item.y}px, 0)`;

        // ÙƒØ´Ù Ø§Ù„ØªØµØ§Ø¯Ù…
        const itemRect = item.el.getBoundingClientRect();
        if (
          itemRect.bottom >= playerRect.top + 20 &&
          itemRect.top <= playerRect.bottom - 20 &&
          itemRect.left <= playerRect.right - 20 &&
          itemRect.right >= playerRect.left + 20
        ) {
          this.handleCollision(item, i, playerRect);
        }
        // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªÙŠ Ø®Ø±Ø¬Øª Ù…Ù† Ø§Ù„Ø´Ø§Ø´Ø©
        else if (item.y > window.innerHeight) {
          item.el.remove();
          this.items.splice(i, 1);
        }
      }
    }
    requestAnimationFrame((t) => this.loop(t));
  },

  handleCollision(item, index, pRect) {
    // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¹Ù†ØµØ±
    item.el.remove();
    this.items.splice(index, 1);

    if (item.isGood) {
      // ØªØ£Ø«ÙŠØ± Ø¥ÙŠØ¬Ø§Ø¨ÙŠ
      this.score += 10;
      this.playSound(audio.catch);
      this.showFloatScore(pRect.left, pRect.top, "+10");
    } else {
      // ØªØ£Ø«ÙŠØ± Ø³Ù„Ø¨ÙŠ
      this.elements.stage.classList.add('shake');
      setTimeout(() => this.elements.stage.classList.remove('shake'), 500);
      
      if (item.type === 'ğŸ”¥') {
        this.lives--;
        this.elements.stage.classList.add('flash-red');
        setTimeout(() => this.elements.stage.classList.remove('flash-red'), 300);
        this.playSound(audio.hurt);
        this.triggerComic();
      } else {
        // Ø«Ù„Ø¬
        this.score = Math.max(0, this.score - 15);
        this.elements.stage.classList.add('flash-blue');
        setTimeout(() => this.elements.stage.classList.remove('flash-blue'), 300);
        this.playSound(audio.hurt);
        this.showFloatScore(pRect.left, pRect.top, "-15", "red");
      }
    }
    
    this.updateUI();
    if (this.lives <= 0) this.gameOver();
  },

  triggerComic() {
    this.elements.comic.classList.add('show');
    this.playSound(audio.false);
    setTimeout(() => this.elements.comic.classList.remove('show'), 2000);
  },

  showFloatScore(x, y, text, color = "#ffcc00") {
    const el = document.createElement('div');
    el.className = 'float-score';
    el.textContent = text;
    el.style.color = color;
    el.style.left = x + 'px';
    el.style.top = y + 'px';
    this.elements.stage.appendChild(el);
    setTimeout(() => el.remove(), 800);
  },

  updateUI() {
    this.elements.score.innerText = this.score;
    let hearts = "";
    for(let i=0; i<3; i++) hearts += i < this.lives ? "â¤ï¸" : "ğŸ–¤";
    this.elements.lives.innerText = hearts;
  },

  gameOver() {
    this.active = false;
    audio.bgm.pause();
    this.elements.finalScore.innerText = this.score;
    this.elements.endScreen.classList.add('active');
    if(this.score < 100) this.playSound(audio.low);
  },

  playSound(snd) {
    snd.currentTime = 0;
    snd.play().catch(() => {});
  }
};

// ØªØ´ØºÙŠÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
window.onload = () => game.init();

</script>
</body>
</html>